<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Introdução a Web Scraping com R</title>
    <meta charset="utf-8" />
    <meta name="author" content="Jodavid Ferreira" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link rel="stylesheet" href="css/jodavid.css" type="text/css" />
    <link rel="stylesheet" href="css/mmp.css" type="text/css" />
    <link rel="stylesheet" href="css/mmp-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Introdução a Web Scraping com R
### Jodavid Ferreira
### 31.jan.2021

---

layout: true

&lt;div class="my-footer"&gt;&lt;span&gt;

&lt;a href="http://jodavid.github.io"&gt;Jodavid Ferreira&lt;/a&gt; - email: &lt;a href="mailto:jdaf1@de.ufpe.br"&gt;jdaf1@de.ufpe.br&lt;/a&gt;
&lt;/span&gt;&lt;/div&gt;


---





&lt;br/&gt;
# O que é Web Scrapping?

&lt;br/&gt;
* O **Web Scraping** é uma área da **Text Mining**;


&lt;br/&gt;&lt;br/&gt;
### O que é Text Mining?

&lt;br/&gt;
*  Text Mining ou Mineração de texto é o processo de **destilar**&lt;sup&gt;1&lt;/sup&gt; **insights** do texto.


.footnote[
[1] A destilação é uma técnica de separação.
]

---

### Onde a mineração de texto se encaixa?

&lt;br/&gt;
* Para acadêmicos, pode auxiliar na compreensão de transcrições qualitativas ou num estudo da linguagem;

&lt;br/&gt;
* Para empresas, pode render informações interessantes que auxiliarão na modelagem preditiva por exemplo;

&lt;br/&gt;
* Aos profissionais de marketing, podem auxiliar na criação de textos, fornecendo recomendações precisas para sua organização.
&lt;!--isso porque através de análises de textos externos, eles podem criar os seus fornecendo recomendações precisas para sua organização.--&gt;

&lt;br/&gt;
* Então, a mineração de texto pode ser usada em qualquer decisão baseada em dados, onde o texto se encaixa naturalmente como uma entrada.


---

# Pacote `rvest`

&lt;br/&gt;
&lt;br/&gt;

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="https://raw.githubusercontent.com/tidyverse/rvest/master/man/figures/logo.png" alt="&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Logo - rvest &amp;lt;/center&amp;gt;&amp;lt;/b&amp;gt;" width="20%" /&gt;
&lt;p class="caption"&gt;&lt;center&gt;&lt;b&gt;Logo - rvest &lt;/center&gt;&lt;/b&gt;&lt;/p&gt;
&lt;/div&gt;

&lt;br/&gt;


`rvest` ajuda você a extrair (ou colher) dados de páginas da web.

Ele foi projetado para funcionar com *magrittr* (pacote responsável pelo operador pipe *%&gt;%*) para facilitar a expressão de tarefas comuns de web scraping, inspiradas em bibliotecas como a `beautiful soup` e `RoboBrowser`.

&lt;!--
Se você estiver copiando várias páginas, recomendo fortemente o uso de rvest em conjunto com educado. O pacote educado garante que você respeite o robots.txt e não martele o site com muitas solicitações.
--&gt;

---

# O que é HTML e CSS ?

* **HTML** (HyperText Markup Language - Linguagem de Marcação de Hipertexto) - é uma linguagem de marcação usada para estruturar uma página web.

* **CSS** (Cascading Style Sheets - Folha de Estilo em Cascata) - é usado para estilizar os elementos escritos no *HTML*.



### O que precisa saber ?

Em **HTML** e **CSS**, existe a possibilidade de aplicar estilos através de 'class' e 'id';



* **HTML** : 
 * *class* : é o atributo global formado por uma lista das classes de um elemento, separada por espaços.
&lt;!-- Classes permitem a CSS e Javascript selecionar e acessar elementos específicos através dos seletores de classe ou funções como o método DOM. --&gt;
  * *id* : define um identificador exclusivo (ID) que deve ser único por todo o documento.
&lt;!--Seu objetivo é identificar o elemento ao navegar por âncoras (usando um identificador de fragmento), quando utilizar scripts ou estilizando (com CSS).--&gt;

* **CSS**: usado para personalizar a parte visual dos sites.

---

# Instalando o `rvest`

&lt;br/&gt;
Instalando o `rvest` através do `devtools`

&lt;br/&gt;

```r
install.packages("devtools")
library(devtools)
devtools::install_github("tidyverse/rvest")
```

&lt;br/&gt;
&lt;br/&gt;
Lendo o pacote:

&lt;br/&gt;

```r
library(rvest)
```

---

## Exemplo 1: Extraindo informações site Jarbas

### Projeto Serenata de Amor

O estudo será realizado sobre o projeto “SERENATA DE AMOR” [https://serenata.ai/](https://serenata.ai/), que é um projeto aberto no qual usa data science (ciência de dados) - a mesma tecnolgia usada por gigantes como Google, Facebook e Netflix - com o objetivo de monitorar os gastos públicos e compartilhar informações de forma acessível a todos.


* Jarbas - [https://jarbas.serenata.ai/dashboard/chamber_of_deputies/reimbursement/](https://jarbas.serenata.ai/dashboard/chamber_of_deputies/reimbursement/)


&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="imagens/jarbas.png" alt="&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;site Jarbas &amp;lt;/center&amp;gt;&amp;lt;/b&amp;gt;" width="100%" /&gt;
&lt;p class="caption"&gt;&lt;center&gt;&lt;b&gt;site Jarbas &lt;/center&gt;&lt;/b&gt;&lt;/p&gt;
&lt;/div&gt;



---

## Exemplo 1: Extraindo informações site Jarbas

### Passo 1: Lendo a URL

Usando a função `read_html` do pacote `xml2` (este pacote é uma dependência do `rvest`) para ler a url.


```r
library(rvest)

url &lt;- "https://jarbas.serenata.ai/dashboard/chamber_of_deputies/reimbursement/"
jarbas_webpage &lt;- read_html(url)
```

---


## Exemplo 1: Extraindo informações site Jarbas

### Passo 2: Extrair dados de classes do CSS

Class: *.field-congressperson_name*

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="imagens/field-congresso-name.png" alt="&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;class:  .field-congressperson_name &amp;lt;/center&amp;gt;&amp;lt;/b&amp;gt;" width="100%" /&gt;
&lt;p class="caption"&gt;&lt;center&gt;&lt;b&gt;class:  .field-congressperson_name &lt;/center&gt;&lt;/b&gt;&lt;/p&gt;
&lt;/div&gt;

---


## Exemplo 1: Extraindo informações site Jarbas

### Passo 2:


Duas funções serão utilizadas aqui:

1. *html_nodes*: Use esta função para extrair os nós que desejamos (neste caso nós com ".field-congressperson_name" como classe css)
2. *html_text*: Use esta função para extrair o texto entre dos nós html (neste caso, os nomes de nossos representantes)


```r
#Scraping  usando classe css ‘field-congressperson_name’
jarbas_names_html &lt;-html_nodes(jarbas_webpage, '.field-congressperson_name')
jarbas_names &lt;- html_text(jarbas_names_html)
head(jarbas_names,3)
```

```
## [1] "Valmir Assunção" "Hélio Leite"     "Hélio Leite"
```

---

## Exemplo 1: Extraindo informações site Jarbas

### Passo 2:



```r
#SUBQUOTA TRANSLATED
jarbas_subquota_html &lt;-html_nodes(jarbas_webpage, '.field-subquota_translated')
jarbas_subquota &lt;- html_text(jarbas_subquota_html)
head(jarbas_subquota,3)
```

```
## [1] "Combustíveis e lubrificantes"        "Divulgação da atividade parlamentar" "Divulgação da atividade parlamentar"
```

```r
#Fornecedor
jarbas_provider_html &lt;-html_nodes(jarbas_webpage, '.field-supplier_info')
jarbas_provider &lt;- html_text(jarbas_provider_html)
head(jarbas_provider,3)
```

```
## [1] "POSTO MK 107 NORTE LTDA05.625.571/0001-35"                         "PRISCILLA DE CASSIA PORTELA VINHOTE 7054665724934.314.072/0001-25" "M SANTOS GUIMARAES EIRELI23.936.281/0001-94"
```

```r
#Valores em Real
jarbas_value_html &lt;-html_nodes(jarbas_webpage, '.field-value')
jarbas_value &lt;- html_text(jarbas_value_html)
head(jarbas_value,3)
```

```
## [1] "R$ 198,84" "R$ 900,00" "R$ 300,00"
```

---

## Exemplo 1: Extraindo informações site Jarbas

### Passo 2:

A seguir serão mostrados o valor do reembolso, eles são extraídos
em tipo de variável caracter: Ex: R\$ 139,76, R\$ 40,23.
Entretanto, como desejamos manipular esses números, precisamos convertê-los para tipo de variável numérica, dessa forma será utilizado a biblioteca: "*stringr*" mais especificamente a função: `str_extract`. Segue o script para conversão da variável.


```r
library(stringr)
#Conversão para tipo numérico
jarbas_value &lt;- as.numeric(sub(",",".",
                str_extract(jarbas_value,pattern = "\\-*\\d+,\\s{0,}\\d+")))
head(jarbas_value,3)
```

```
## [1] 198.84 900.00 300.00
```

---

## Exemplo 1: Extraindo informações site Jarbas

### Passo 3: Geração de data.frame


```r
#Combinando todas as características obtidas
jarbas_names &lt;- str_extract(jarbas_names,pattern = boundary("word"))
jarbas_df &lt;- data.frame(
  Name = jarbas_names,
  Subquota = jarbas_subquota,
  Provider = jarbas_provider,
  Value = jarbas_value
  )

#Mostrando tipo das variáveis
str(jarbas_df)
```

```
## 'data.frame':	100 obs. of  4 variables:
##  $ Name    : chr  "Valmir" "Hélio" "Hélio" "Hélio" ...
##  $ Subquota: chr  "Combustíveis e lubrificantes" "Divulgação da atividade parlamentar" "Divulgação da atividade parlamentar" "Combustíveis e lubrificantes" ...
##  $ Provider: chr  "POSTO MK 107 NORTE LTDA05.625.571/0001-35" "PRISCILLA DE CASSIA PORTELA VINHOTE 7054665724934.314.072/0001-25" "M SANTOS GUIMARAES EIRELI23.936.281/0001-94" "SUPER POSTO PALMEIRA LTDA83.838.839/0001-20" ...
##  $ Value   : num  199 900 300 5022 13000 ...
```

---

## Exemplo 1: Extraindo informações site Jarbas

### Passo 4: Geração de um gráfico

Foram utilizados as 50 primeiras linhas do data.frame e uma biblioteca *ggplot2* para geração do gráfico.


```r
library(ggplot2)

jarbas_df &lt;- jarbas_df[1:50,]

ggplot(
  jarbas_df, aes(Value,Name,colour=Subquota)) +
  geom_point() +
  labs(title="", x ="pedidos de reembolso (R$)",
       y = "deputados",colour="SUBQUOTA TRANSLATED")
```


---

&lt;img src="index_files/figure-html/unnamed-chunk-12-1.png" style="display: block; margin: auto;" /&gt;

---

## Exemplo 2: Dados do COVID-19 da PB

Obter dados da COVID-19 do projeto [https://brasil.io/home/](https://brasil.io/home/).
O projeto Brasil em dados libertos, 
conta com 40 voluntários que, diariamente, compilam boletins epidemiológicos das 27 Secretarias Estaduais de Saúde, disponibilizamos uma base de dados com a série histórica de casos e óbitos confirmados por município. 


* Brasil.io (dados COVID19-PB) - [https://brasil.io/covid19/PB/](https://brasil.io/covid19/PB/)


&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="imagens/covid19.png" alt="&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;site Brasil.io &amp;lt;/center&amp;gt;&amp;lt;/b&amp;gt;" width="100%" /&gt;
&lt;p class="caption"&gt;&lt;center&gt;&lt;b&gt;site Brasil.io &lt;/center&gt;&lt;/b&gt;&lt;/p&gt;
&lt;/div&gt;

---

## Exemplo 2: Dados do COVID-19 da PB

### Passo 1: Lendo a URL


```r
library(rvest)

url &lt;- "https://brasil.io/covid19/PB/"
covidpb_webpage &lt;- read_html(url)
```

---


## Exemplo 2: Dados do COVID-19 da PB

### Passo 2:
  

```r
#Scraping  usando classe css ‘dataTables_scrollBody’
covidpb_names_html &lt;-html_nodes(covidpb_webpage, '.table')
covidpb_names &lt;- html_text(covidpb_names_html)
head(covidpb_names,3)
```

```
## [1] " Data \n Município \n Confirmados \n Confirmadospor 100k hab. \n Óbitos \n Letalidade \n Óbitospor 100k hab. \n 29/01/2021 \n Água Branca \n 552 \n 5.356,10 \n 8 \n 1,45% \n 77,62 \n 29/01/2021 \n Aguiar \n 66 \n 1.172,29 \n 1 \n 1,52% \n 17,76 \n 29/01/2021 \n Alagoa Grande \n 1.818 \n 6.392,63 \n 30 \n 1,65% \n 105,49 \n 29/01/2021 \n Alagoa Nova \n 494 \n 2.361,26 \n 11 \n 2,23% \n 52,58 \n 29/01/2021 \n Alagoinha \n 1.149 \n 7.891,48 \n 16 \n 1,39% \n 109,89 \n 29/01/2021 \n Alcantil \n 111 \n 2.014,88 \n 1 \n 0,90% \n 18,15 \n 29/01/2021 \n Algodão de Jandaíra \n 48 \n 1.862,63 \n 0 \n 0,00% \n 0,00 \n 29/01/2021 \n Alhandra \n 812 \n 4.116,19 \n 19 \n 2,34% \n 96,31 \n 29/01/2021 \n Amparo \n 47 \n 2.087,96 \n 1 \n 2,13% \n 44,42 \n 29/01/2021 \n Aparecida \n 575 \n 6.832,22 \n 8 \n 1,39% \n 95,06 \n 29/01/2021 \n Araçagi \n 649 \n 3.835,47 \n 7 \n 1,08% \n 41,37 \n 29/01/2021 \n Arara \n 311 \n 2.296,56 \n 9 \n 2,89% \n 66,46 \n 29/01/2021 \n Araruna \n 494 \n 2.414,11 \n 15 \n 3,04% \n 73,30 \n 29/01/2021 \n Areia \n 637 \n 2.811,62 \n 6 \n 0,94% \n 26,48 \n 29/01/2021 \n Areia de Baraúnas \n 16 \n 756,14 \n 0 \n 0,00% \n 0,00 \n 29/01/2021 \n Areial \n 127 \n 1.807,31 \n 5 \n 3,94% \n 71,15 \n 29/01/2021 \n Aroeiras \n 356 \n 1.862,31 \n 3 \n 0,84% \n 15,69 \n 29/01/2021 \n Assunção \n 93 \n 2.308,27 \n 0 \n 0,00% \n 0,00 \n 29/01/2021 \n Baía da Traição \n 958 \n 10.532,10 \n 8 \n 0,84% \n 87,95 \n 29/01/2021 \n Bananeiras \n 613 \n 2.882,13 \n 3 \n 0,49% \n 14,11 \n 29/01/2021 \n Baraúna \n 156 \n 3.142,63 \n 0 \n 0,00% \n 0,00 \n 29/01/2021 \n Barra de Santana \n 247 \n 2.958,44 \n 3 \n 1,21% \n 35,93 \n 29/01/2021 \n Barra de Santa Rosa \n 445 \n 2.871,52 \n 2 \n 0,45% \n 12,91 \n 29/01/2021 \n Barra de São Miguel \n 169 \n 2.786,48 \n 1 \n 0,59% \n 16,49 \n 29/01/2021 \n Bayeux \n\n 2.995 \n 3.081,18 \n 134 \n 4,47% \n 137,86 \n 29/01/2021 \n Belém \n 1.222 \n 6.902,01 \n 19 \n 1,55% \n 107,31 \n 29/01/2021 \n Belém do Brejo do Cruz \n 418 \n 5.687,85 \n 5 \n 1,20% \n 68,04 \n 29/01/2021 \n Bernardino Batista \n 172 \n 4.864,25 \n 0 \n 0,00% \n 0,00 \n 29/01/2021 \n Boa Ventura \n 155 \n 2.920,67 \n 3 \n 1,94% \n 56,53 \n 29/01/2021 \n Boa Vista \n 185 \n 2.592,49 \n 2 \n 1,08% \n 28,03 \n 29/01/2021 \n Bom Jesus \n 76 \n 2.951,46 \n 3 \n 3,95% \n 116,50 \n 29/01/2021 \n Bom Sucesso \n 72 \n 1.452,78 \n 0 \n 0,00% \n 0,00 \n 29/01/2021 \n Bonito de Santa Fé \n 322 \n 2.678,42 \n 11 \n 3,42% \n 91,50 \n 29/01/2021 \n  Boqueirão \n 941 \n 5.265,81 \n 14 \n 1,49% \n 78,34 \n 29/01/2021 \n Borborema \n 96 \n 1.815,77 \n 1 \n 1,04% \n 18,91 \n 29/01/2021 \n Brejo do Cruz \n 1.035 \n 7.285,65 \n 12 \n 1,16% \n 84,47 \n 29/01/2021 \n Brejo dos Santos \n 131 \n 2.026,61 \n 3 \n 2,29% \n 46,41 \n 29/01/2021 \n Caaporã \n 1.210 \n 5.511,27 \n 19 \n 1,57% \n 86,54 \n 29/01/2021 \n Cabaceiras \n 220 \n 3.886,24 \n 0 \n 0,00% \n 0,00 \n 29/01/2021 \n Cabedelo \n 4.705 \n 6.841,94 \n 97 \n 2,06% \n 141,06 \n 29/01/2021 \n Cachoeira dos Índios \n 333 \n 3.231,44 \n 10 \n 3,00% \n 97,04 \n 29/01/2021 \n Cacimba de Areia \n 20 \n 541,27 \n 0 \n 0,00% \n 0,00 \n 29/01/2021 \n Cacimba de Dentro \n 711 \n 4.139,02 \n 17 \n 2,39% \n 98,96 \n 29/01/2021 \n Cacimbas \n 101 \n 1.402,97 \n 5 \n 4,95% \n 69,45 \n 29/01/2021 \n Caiçara \n 489 \n 6.800,17 \n 10 \n 2,04% \n 139,06 \n 29/01/2021 \n Cajazeiras \n 3.877 \n 6.224,21 \n 71 \n 1,83% \n 113,98 \n 29/01/2021 \n Cajazeirinhas \n 69 \n 2.152,89 \n 0 \n 0,00% \n 0,00 \n 29/01/2021 \n Caldas Brandão \n 368 \n 6.086,67 \n 5 \n 1,36% \n 82,70 \n 29/01/2021 \n Camalaú \n 201 \n 3.332,78 \n 2 \n 1,00% \n 33,16 \n 29/01/2021 \n Campina Grande \n 17.171 \n 4.169,67 \n 506 \n 2,95% \n 122,87 \n 29/01/2021 \n Capim \n 177 \n 2.673,72 \n 8 \n 4,52% \n 120,85 \n 29/01/2021 \n Caraúbas \n 110 \n 2.628,43 \n 5 \n 4,55% \n 119,47 \n 29/01/2021 \n Carrapateira \n 144 \n 5.359,14 \n 1 \n 0,69% \n 37,22 \n 29/01/2021 \n Casserengue \n 527 \n 7.027,60 \n 7 \n 1,33% \n 93,35 \n 29/01/2021 \n Catingueira \n 49 \n 992,91 \n 2 \n 4,08% \n 40,53 \n 29/01/2021 \n Catolé do Rocha \n 1.530 \n 4.986,31 \n 25 \n 1,63% \n 81,48 \n 29/01/2021 \n Caturité \n 144 \n 2.953,85 \n 2 \n 1,39% \n 41,03 \n 29/01/2021 \n Conceição \n 814 \n 4.282,63 \n 12 \n 1,47% \n 63,13 \n 29/01/2021 \n Condado \n 283 \n 4.250,53 \n 7 \n 2,47% \n 105,14 \n 29/01/2021 \n Conde \n 1.177 \n 4.706,12 \n 21 \n 1,78% \n 83,97 \n 29/01/2021 \n Congo \n 130 \n 2.715,69 \n 5 \n 3,85% \n 104,45 \n 29/01/2021 \n Coremas \n 483 \n 3.128,04 \n 13 \n 2,69% \n 84,19 \n 29/01/2021 \n Coxixola \n 89 \n 4.599,48 \n 2 \n 2,25% \n 103,36 \n 29/01/2021 \n Cruz do Espírito Santo \n 716 \n 4.100,57 \n 22 \n 3,07% \n 126,00 \n 29/01/2021 \n Cubati \n 171 \n 2.183,35 \n 3 \n 1,75% \n 38,30 \n 29/01/2021 \n Cuité \n 853 \n 4.194,94 \n 6 \n 0,70% \n 29,51 \n 29/01/2021 \n Cuité de Mamanguape \n 210 \n 3.303,96 \n 11 \n 5,24% \n 173,06 \n 29/01/2021 \n Cuitegi \n 439 \n 6.479,70 \n 11 \n 2,51% \n 162,36 \n 29/01/2021 \n Curral de Cima \n 143 \n  2.740,51 \n 2 \n 1,40% \n 38,33 \n 29/01/2021 \n Curral Velho \n 61 \n 2.428,34 \n 0 \n 0,00% \n 0,00 \n 29/01/2021 \n Damião \n 188 \n 3.500,93 \n 2 \n 1,06% \n 37,24 \n 29/01/2021 \n Desterro \n 155 \n 1.864,10 \n 3 \n 1,94% \n 36,08 \n 29/01/2021 \n Diamante \n 320 \n 4.901,96 \n 4 \n 1,25% \n 61,27 \n 29/01/2021 \n Dona Inês \n 167 \n 1.603,76 \n 3 \n 1,80% \n 28,81 \n 29/01/2021 \n Duas Estradas \n 112 \n 3.126,74 \n 3 \n 2,68% \n 83,75 \n 29/01/2021 \n Emas \n 80 \n 2.260,53 \n 4 \n 5,00% \n 113,03 \n 29/01/2021 \n Esperança \n 1.474 \n 4.439,89 \n 27 \n 1,83% \n 81,33 \n 29/01/2021 \n Fagundes \n 154 \n 1.373,16 \n 6 \n 3,90% \n 53,50 \n 29/01/2021 \n Frei Martinho \n 44 \n 1.472,06 \n 0 \n 0,00% \n 0,00 \n 29/01/2021 \n Gado Bravo \n 142 \n 1.710,23 \n 2 \n 1,41% \n 24,09 \n 29/01/2021 \n Guarabira \n 5.571 \n 9.424,00 \n 80 \n 1,44% \n 135,33 \n 29/01/2021 \n Gurinhém \n 514 \n 3.638,42 \n 10 \n 1,95% \n 70,79 \n 29/01/2021 \n Gurjão \n 66 \n 1.911,38 \n 2 \n 3,03% \n 57,92 \n 29/01/2021 \n Ibiara \n 299 \n 5.065,22 \n 2 \n 0,67% \n 33,88 \n 29/01/2021 \n Igaracy \n 46 \n 753,48 \n 3 \n 6,52% \n 49,14 \n 29/01/2021 \n Imaculada \n 251 \n 2.118,50 \n 8 \n 3,19% \n 67,52 \n 29/01/2021 \n Ingá \n 1.863 \n 10.267,86 \n 23 \n 1,23% \n 126,76 \n 29/01/2021 \n Itabaiana \n 1.607 \n 6.580,94 \n 35 \n 2,18% \n 143,33 \n 29/01/2021 \n Itaporanga \n 1.294 \n 5.211,86 \n 18 \n 1,39% \n 72,50 \n 29/01/2021 \n Itapororoca \n 1.186 \n 6.300,80 \n 12 \n 1,01% \n 63,75 \n 29/01/2021 \n Itatuba \n 459 \n 4.166,67 \n 5 \n 1,09% \n 45,39 \n 29/01/2021 \n Jacaraú \n 411 \n 2.844,29 \n 12 \n 2,92% \n 83,04 \n 29/01/2021 \n Jericó \n 306 \n 3.950,94 \n 4 \n 1,31% \n 51,65 \n 29/01/2021 \n João Pessoa \n 49.197 \n 6.017,90 \n 1.263 \n 2,57% \n 154,49 \n 29/01/2021 \n Joca Claudino \n 37 \n 1.402,05 \n 0 \n 0,00% \n 0,00 \n 29/01/2021 \n Juarez Távora \n 477 \n 5.980,44 \n 6 \n 1,26% \n 75,23 \n 29/01/2021 \n Juazeirinho \n 356 \n 1.945,57 \n 3 \n 0,84% \n 16,40 \n 29/01/2021 \n Junco do Seridó \n 150 \n 2.084,78 \n 5 \n 3,33% \n 69,49 \n 29/01/2021 \n Juripiranga \n 699 \n 6.476,42 \n 15 \n 2,15% \n 138,98 \n 29/01/2021 \n Juru \n 509 \n 5.168,04 \n 8 \n 1,57% \n 81,23 \n 29/01/2021 \n Lagoa \n 30 \n 644,75 \n 1 \n 3,33% \n 21,49 \n 29/01/2021 \n Lagoa de Dentro \n 254 \n 3.282,93 \n 4 \n 1,57% \n 51,70 \n 29/01/2021 \n Lagoa Seca \n 1.093 \n 3.957,71 \n 23 \n 2,10% \n 83,28 \n 29/01/2021 \n Lastro \n 111 \n 4.083,89 \n 0 \n 0,00% \n 0,00 \n 29/01/2021 \n Livramento \n 125 \n 1.720,58 \n 0 \n 0,00% \n 0,00 \n 29/01/2021 \n Logradouro \n 251 \n 5.745,02 \n 7 \n 2,79% \n 160,22 \n 29/01/2021 \n Lucena \n 690 \n 5.221,73 \n 11 \n 1,59% \n 83,25 \n 29/01/2021 \n Mãe d'Água \n 90 \n 2.250,56 \n 3 \n 3,33% \n 75,02 \n 29/01/2021 \n Malta \n 166 \n 2.885,95 \n 5 \n 3,01% \n 86,93 \n 29/01/2021 \n Mamanguape \n 3.037 \n 6.728,55 \n 44 \n 1,45% \n 97,48 \n 29/01/2021 \n Manaíra \n 67 \n 610,65 \n 3 \n 4,48% \n 27,34 \n 29/01/2021 \n Marcação \n 613 \n 7.084,25 \n 4 \n 0,65% \n 46,23 \n 29/01/2021 \n Mari \n 1.327 \n 6.068,78 \n 23 \n 1,73% \n 105,19 \n 29/01/2021 \n Marizópolis \n 147 \n 2.209,20 \n 5 \n 3,40% \n 75,14 \n 29/01/2021 \n Massaranduba \n 560 \n 4.000,57 \n 10 \n 1,79% \n 71,44 \n 29/01/2021 \n Mataraca \n 317 \n 3.712,38 \n 8 \n 2,52% \n 93,69 \n 29/01/2021 \n Matinhas \n 93 \n 2.059,80 \n 4 \n 4,30% \n 88,59 \n 29/01/2021 \n Mato Grosso \n 26 \n 888,59 \n 1 \n 3,85% \n 34,18 \n 29/01/2021 \n Maturéia \n 64 \n 965,31 \n 2 \n 3,12% \n 30,17 \n 29/01/2021 \n Mogeiro \n 462 \n 3.483,90 \n 8 \n 1,73% \n 60,33 \n 29/01/2021 \n Montadas \n 120 \n 2.091,32 \n 2 \n 1,67% \n 34,86 \n 29/01/2021 \n Monte Horebe \n 134 \n 2.767,45 \n 0 \n 0,00% \n 0,00 \n 29/01/2021 \n Monteiro \n 1.911 \n  5.715,91 \n 20 \n 1,05% \n 59,82 \n 29/01/2021 \n Mulungu \n 486 \n 4.893,27 \n 10 \n 2,06% \n 100,68 \n 29/01/2021 \n Natuba \n 107 \n 1.023,83 \n 2 \n 1,87% \n 19,14 \n 29/01/2021 \n Nazarezinho \n 145 \n 1.990,12 \n 2 \n 1,38% \n 27,45 \n 29/01/2021 \n Nova Floresta \n 402 \n 3.783,17 \n 8 \n 1,99% \n 75,29 \n 29/01/2021 \n Nova Olinda \n 127 \n 2.145,27 \n 6 \n 4,72% \n 101,35 \n 29/01/2021 \n Nova Palmeira \n 172 \n 3.468,44 \n 0 \n 0,00% \n 0,00 \n 29/01/2021 \n Olho d'Água \n 161 \n 2.491,49 \n 5 \n 3,11% \n 77,38 \n 29/01/2021 \n Olivedos \n 214 \n 5.402,68 \n 3 \n 1,40% \n 75,74 \n 29/01/2021 \n Ouro Velho \n  60 \n 1.969,80 \n 1 \n 1,67% \n 32,83 \n 29/01/2021 \n Parari \n 22 \n 1.251,42 \n 0 \n 0,00% \n 0,00 \n 29/01/2021 \n Passagem \n 74 \n 3.037,77 \n 1 \n 1,35% \n 41,05 \n 29/01/2021 \n Patos \n 7.792 \n 7.202,01 \n 123 \n 1,58% \n 113,69 \n 29/01/2021 \n Paulista \n 503 \n 4.063,33 \n 3 \n 0,60% \n 24,23 \n 29/01/2021 \n Pedra Branca \n 132 \n 3.471,86 \n 1 \n 0,76% \n 26,30 \n 29/01/2021 \n Pedra Lavrada \n 70 \n 886,19 \n 1 \n 1,43% \n 12,66 \n 29/01/2021 \n Pedras de Fogo \n 1.478 \n 5.179,97 \n 38 \n 2,57% \n 133,18 \n 29/01/2021 \n Pedro Régis \n 155 \n 2.535,17 \n 6 \n 3,87% \n 98,14 \n 29/01/2021 \n Piancó \n 328 \n 2.035,88 \n 11 \n 3,35% \n 68,28 \n 29/01/2021 \n Picuí \n 587 \n 3.135,68 \n 10 \n 1,70% \n 53,42 \n 29/01/2021 \n Pilar \n 647 \n 5.402,02 \n 17 \n 2,63% \n 141,94 \n 29/01/2021 \n Pilões \n 151 \n 2.296,23 \n 3 \n 1,99% \n 45,62 \n 29/01/2021 \n Pilõezinhos \n 398 \n 8.032,29 \n 4 \n 1,01% \n 80,73 \n 29/01/2021 \n Pirpirituba \n 444 \n 4.195,01 \n 7 \n 1,58% \n 66,14 \n 29/01/2021 \n Pitimbu \n 936 \n 4.856,03 \n 10 \n 1,07% \n 51,88 \n 29/01/2021 \n Pocinhos \n 452 \n 2.416,08 \n 8 \n 1,77% \n 42,76 \n 29/01/2021 \n Poço Dantas \n 55 \n 1.416,80 \n 2 \n 3,64% \n 51,52 \n 29/01/2021 \n Poço de José de Moura \n 127 \n 2.928,29 \n 0 \n 0,00% \n 0,00 \n 29/01/2021 \n Pombal \n 1.906 \n 5.810,62 \n 28 \n 1,47% \n 85,36 \n 29/01/2021 \n Prata \n 34 \n 802,27 \n 2 \n 5,88% \n 47,19 \n 29/01/2021 \n Princesa Isabel \n 729 \n 3.095,67 \n 19 \n 2,61% \n 80,68 \n 29/01/2021 \n Puxinanã \n 376 \n 2.736,34 \n 3 \n 0,80% \n 21,83 \n 29/01/2021 \n Queimadas \n 1.958 \n 4.431,97 \n 32 \n 1,63% \n 72,43 \n 29/01/2021 \n Quixaba \n 53 \n 2.672,72 \n 2 \n 3,77% \n 100,86 \n 29/01/2021 \n Remígio \n 543 \n 2.742,70 \n 11 \n 2,03% \n 55,56 \n 29/01/2021 \n Riachão \n 91 \n 2.514,51 \n 2 \n 2,20% \n 55,26 \n 29/01/2021 \n Riachão do Bacamarte \n 265 \n 5.835,72 \n 0 \n 0,00% \n 0,00 \n 29/01/2021 \n Riachão do Poço \n 122 \n 2.687,22 \n 3 \n 2,46% \n 66,08 \n 29/01/2021 \n Riacho de Santo Antônio \n 50 \n 2.532,93 \n 1 \n 2,00% \n 50,66 \n 29/01/2021 \n Riacho dos Cavalos \n 232 \n 2.716,31 \n 4 \n 1,72% \n 46,83 \n 29/01/2021 \n Rio Tinto \n 1.549 \n 6.396,07 \n 32 \n 2,07% \n 132,13 \n 29/01/2021 \n Salgadinho \n 52 \n 1.322,82 \n 0 \n 0,00% \n 0,00 \n 29/01/2021 \n Salgado de São Félix \n 513 \n 4.228,84 \n 9 \n 1,75% \n 74,19 \n 29/01/2021 \n Santa Cecília \n 108 \n 1.651,12 \n 1 \n 0,93% \n 15,29 \n 29/01/2021 \n Santa Cruz \n 113 \n 1.717,06 \n 2 \n 1,77% \n 30,39 \n 29/01/2021 \n Santa Helena \n 68 \n 1.158,24 \n 1 \n 1,47% \n 17,03 \n 29/01/2021 \n Santa Inês \n 116 \n 3.228,50 \n 3 \n 2,59% \n 83,50 \n 29/01/2021 \n Santa Luzia \n 633 \n 4.103,46 \n 11 \n 1,74% \n 71,31 \n 29/01/2021 \n Santana de Mangueira \n 181 \n 3.528,95 \n 1 \n 0,55% \n 19,50 \n 29/01/2021 \n Santana dos Garrotes \n 167 \n 2.390,50 \n 3 \n 1,80% \n 42,94 \n 29/01/2021 \n Santa Rita \n 4.822 \n 3.510,76 \n 187 \n 3,88% \n 136,15 \n 29/01/2021 \n Santa Teresinha \n 102 \n 2.235,86 \n 5 \n 4,90% \n 109,60 \n 29/01/2021 \n Santo André \n 143 \n 5.699,48 \n 0 \n 0,00% \n 0,00 \n 29/01/2021 \n São Bentinho \n\n 169 \n 3.701,27 \n 3 \n 1,78% \n 65,70 \n 29/01/2021 \n São Bento \n 4.120 \n 11.996,27 \n 42 \n 1,02% \n 122,29 \n 29/01/2021 \n São Domingos \n 67 \n 2.163,38 \n 0 \n 0,00% \n 0,00 \n 29/01/2021 \n São Domingos do Cariri \n 72 \n 2.737,64 \n 3 \n 4,17% \n 114,07 \n 29/01/2021 \n São Francisco \n 74 \n 2.186,76 \n 2 \n 2,70% \n 59,10 \n 29/01/2021 \n São João do Cariri \n 242 \n 5.783,94 \n 1 \n 0,41% \n 23,90 \n 29/01/2021 \n São João do Rio do Peixe \n 532 \n 2.951,29 \n 8 \n 1,50% \n 44,38 \n 29/01/2021 \n São João do Tigre \n 48 \n 1.087,20 \n 1 \n 2,08% \n 22,65 \n 29/01/2021 \n São José da Lagoa Tapada \n 276 \n 3.619,20 \n 2 \n 0,72% \n 26,23 \n 29/01/2021 \n São José de Caiana \n 194 \n 3.042,66 \n 3 \n 1,55% \n 47,05 \n 29/01/2021 \n São José de Espinharas \n 148 \n 3.178,69 \n 2 \n 1,35% \n 42,96 \n 29/01/2021 \n São José de Piranhas \n 872 \n 4.289,44 \n 17 \n 1,95% \n 83,62 \n 29/01/2021 \n São José de Princesa \n 70 \n 1.772,15 \n 1 \n 1,43% \n 25,32 \n 29/01/2021 \n São José do Bonfim \n 75 \n 2.090,30 \n 4 \n 5,33% \n 111,48 \n 29/01/2021 \n São José do Brejo do Cruz \n 109 \n 6.018,77 \n 0 \n 0,00% \n 0,00 \n 29/01/2021 \n São José do Sabugi \n 389 \n 9.380,27 \n 2 \n 0,51% \n 48,23 \n 29/01/2021 \n São José dos Cordeiros \n 62 \n 1.713,65 \n 0 \n 0,00% \n 0,00 \n 29/01/2021 \n São José dos Ramos \n 294 \n 4.901,63 \n 3 \n 1,02% \n 50,02 \n 29/01/2021 \n São Mamede \n 119 \n 1.545,05 \n 6 \n 5,04% \n 77,90 \n 29/01/2021 \n São Miguel de Taipu \n 188 \n 2.537,11 \n 6 \n 3,19% \n 80,97 \n 29/01/2021 \n São Sebastião de Lagoa de Roça \n 421 \n 3.589,70 \n 7 \n 1,66% \n 59,69 \n 29/01/2021 \n São Sebastião do Umbuzeiro \n 39 \n 1.110,48 \n 2 \n 5,13% \n 56,95 \n 29/01/2021 \n São Vicente do Seridó \n 69 \n 636,06 \n 1 \n 1,45% \n 9,22 \n 29/01/2021 \n Sapé \n 1.561 \n 2.956,22 \n 67 \n 4,29% \n 126,88 \n 29/01/2021 \n Serra Branca \n 396 \n 2.879,16 \n 13 \n 3,28% \n 94,52 \n 29/01/2021 \n Serra da Raiz \n 159 \n 5.078,25 \n 1 \n 0,63% \n 31,94 \n 29/01/2021 \n Serra Grande \n 123 \n 4.218,11 \n 1 \n 0,81% \n 34,29 \n 29/01/2021 \n Serra Redonda \n 344 \n 4.899,59 \n 5 \n 1,45% \n 71,21 \n 29/01/2021 \n Serraria \n 214 \n 3.526,70 \n 3 \n 1,40% \n 49,44 \n 29/01/2021 \n Sertãozinho \n 363 \n 7.133,03 \n 3 \n 0,83% \n 58,95 \n 29/01/2021 \n Sobrado \n 295 \n 3.774,79 \n 5 \n 1,69% \n 63,98 \n 29/01/2021 \n Solânea \n 1.177 \n 4.487,74 \n 12 \n 1,02% \n 45,75 \n 29/01/2021 \n Soledade \n 351 \n 2.324,20 \n 2 \n 0,57% \n 13,24 \n 29/01/2021 \n Sossêgo \n 105 \n 2.921,54 \n 1 \n 0,95% \n 27,82 \n 29/01/2021 \n Sousa \n 4.612 \n 6.614,75 \n 72 \n 1,56% \n 103,27 \n 29/01/2021 \n Sumé \n 1.428 \n 8.384,71 \n 8 \n 0,56% \n 46,97 \n 29/01/2021 \n Tacima \n 155 \n 1.413,07 \n 4 \n 2,58% \n 36,47 \n 29/01/2021 \n Taperoá \n 260 \n 1.683,83 \n 6 \n 2,31% \n 38,86 \n 29/01/2021 \n Tavares \n 483 \n 3.272,58 \n 3 \n 0,62% \n 20,33 \n 29/01/2021 \n Teixeira \n 290 \n 1.901,89 \n 10 \n 3,45% \n 65,58 \n 29/01/2021 \n Tenório \n 70 \n 2.271,99 \n 2 \n 2,86% \n 64,91 \n 29/01/2021 \n Triunfo \n 266 \n 2.810,65 \n 5 \n 1,88% \n 52,83 \n 29/01/2021 \n Uiraúna \n 267 \n 1.745,10 \n 15 \n 5,62% \n 98,04 \n 29/01/2021 \n Umbuzeiro \n 154 \n 1.553,83 \n 4 \n 2,60% \n 40,36 \n 29/01/2021 \n Várzea \n 70 \n 2.463,92 \n 1 \n 1,43% \n 35,20 \n 29/01/2021 \n Vieirópolis \n 40 \n 744,60 \n 2 \n 5,00% \n 37,23 \n 29/01/2021 \n Vista Serrana \n 60 \n 1.569,04 \n 3 \n 5,00% \n 78,45 \n 29/01/2021 \n Zabelê \n 62 \n 2.749,45 \n 1 \n 1,61% \n 44,35 \n"
```

```r
#Separando por "\n"
vetortotal &lt;- strsplit(covidpb_names,"\n ")

#Transformando em uma matriz
matrizcovid &lt;- matrix(vetortotal[[1]],byrow = T,ncol = 7) #Número de colunas observados no site

#Transformando em um data.frame
covid19pb &lt;- data.frame(matrizcovid)

#Transformando primeira linha nos nomes das colunas
names(covid19pb) &lt;- covid19pb[1,]
covid19pb &lt;- covid19pb[-1,]

head(covid19pb,3)
```

```
##         Data      Município  Confirmados  Confirmadospor 100k hab.  Óbitos  Letalidade  Óbitospor 100k hab. 
## 2 29/01/2021    Água Branca          552                  5.356,10       8       1,45%                77,62 
## 3 29/01/2021         Aguiar           66                  1.172,29       1       1,52%                17,76 
## 4 29/01/2021  Alagoa Grande        1.818                  6.392,63      30       1,65%               105,49
```

---

## Exemplo 2: Dados do COVID-19 da PB
  
### Passo 2:
  
Convertendo a variável data em formato `date` e os casos confirmados em `numericos`.


```r
covid19pb$` Data ` &lt;- as.Date(covid19pb$` Data `, "%d/%m/%Y")

covid19pb$`Confirmados ` &lt;- as.numeric(gsub('\\.', '', covid19pb$`Confirmados `))


str(covid19pb)
```

```
## 'data.frame':	223 obs. of  7 variables:
##  $  Data                    : Date, format: "2021-01-29" "2021-01-29" "2021-01-29" "2021-01-29" ...
##  $ Município                : chr  "Água Branca " "Aguiar " "Alagoa Grande " "Alagoa Nova " ...
##  $ Confirmados              : num  552 66 1818 494 1149 ...
##  $ Confirmadospor 100k hab. : chr  "5.356,10 " "1.172,29 " "6.392,63 " "2.361,26 " ...
##  $ Óbitos                   : chr  "8 " "1 " "30 " "11 " ...
##  $ Letalidade               : chr  "1,45% " "1,52% " "1,65% " "2,23% " ...
##  $ Óbitospor 100k hab.      : chr  "77,62 " "17,76 " "105,49 " "52,58 " ...
```

---
    
### Passo 4: Geração de um gráfico
  
Foram utilizados o data.frame e uma biblioteca *ggplot2* para geração do gráfico.


```r
library(ggplot2)

ggplot(
  covid19pb, aes(`Confirmados `)) +
  geom_histogram() +
  labs(title="", x =paste("Quantidade de Casos Confirmados na data",format(unique(covid19pb$` Data `),"%d-%m-%Y.")),
       y = "")
```

---


&lt;img src="index_files/figure-html/unnamed-chunk-18-1.png" style="display: block; margin: auto;" /&gt;

---
    




# Fontes

* Slide produzido com Rmarkdown, com template
`Xaringan`: [https://github.com/yihui/xaringan](https://github.com/yihui/xaringan).
* Livro: `Text Mining in Practice with R`;

* [https://github.com/tidyverse/rvest](https://github.com/tidyverse/rvest)
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
